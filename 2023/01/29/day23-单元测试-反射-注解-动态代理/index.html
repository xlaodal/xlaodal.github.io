

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="华安">
  <meta name="keywords" content="">
  
    <meta name="description" content="day23-单元测试、反射恭喜同学们，Java主要的知识我们其实已经学习得差不多了。今天同学们再把单元测试、反射、注解、动态代理学习完。Java的基础知识就算全齐活了。 首先，我们进入单元测试的学习。 一、单元测试1.1 单元测试快速入门所谓单元测试，就是针对最小的功能单元，编写测试代码对其进行正确性测试。 我们想想，咱们之前是怎么进行测试的呢？ 比如说我们写了一个学生管理系统，有添加学生、修改学">
<meta property="og:type" content="article">
<meta property="og:title" content="23单元测试、反射">
<meta property="og:url" content="http://example.com/2023/01/29/day23-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-%E5%8F%8D%E5%B0%84-%E6%B3%A8%E8%A7%A3-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/index.html">
<meta property="og:site_name" content="萧代">
<meta property="og:description" content="day23-单元测试、反射恭喜同学们，Java主要的知识我们其实已经学习得差不多了。今天同学们再把单元测试、反射、注解、动态代理学习完。Java的基础知识就算全齐活了。 首先，我们进入单元测试的学习。 一、单元测试1.1 单元测试快速入门所谓单元测试，就是针对最小的功能单元，编写测试代码对其进行正确性测试。 我们想想，咱们之前是怎么进行测试的呢？ 比如说我们写了一个学生管理系统，有添加学生、修改学">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/assets/1668506399372.png">
<meta property="og:image" content="http://example.com/assets/1668506713783.png">
<meta property="og:image" content="http://example.com/assets/1668507051101.png">
<meta property="og:image" content="http://example.com/assets/1668507501024.png">
<meta property="og:image" content="http://example.com/assets/1668508226111.png">
<meta property="og:image" content="http://example.com/assets/1668508373865.png">
<meta property="og:image" content="http://example.com/assets/1668508793279.png">
<meta property="og:image" content="http://example.com/assets/1668509275659.png">
<meta property="og:image" content="http://example.com/assets/1668575265599.png">
<meta property="og:image" content="http://example.com/assets/1668575796295.png">
<meta property="og:image" content="http://example.com/assets/1668576426355.png">
<meta property="og:image" content="http://example.com/assets/1668576691591.png">
<meta property="og:image" content="http://example.com/assets/1668577010983.png">
<meta property="og:image" content="http://example.com/assets/1668578112815.png">
<meta property="og:image" content="http://example.com/assets/1668578397467.png">
<meta property="og:image" content="http://example.com/assets/1668578639149.png">
<meta property="og:image" content="http://example.com/assets/1668578807439.png">
<meta property="og:image" content="http://example.com/assets/1668579315586.png">
<meta property="og:image" content="http://example.com/assets/1668579177901.png">
<meta property="og:image" content="http://example.com/assets/1668579517323.png">
<meta property="og:image" content="http://example.com/assets/1668579681294.png">
<meta property="og:image" content="http://example.com/assets/1668579804732.png">
<meta property="og:image" content="http://example.com/assets/1668580075962.png">
<meta property="og:image" content="http://example.com/assets/1668580288930.png">
<meta property="og:image" content="http://example.com/assets/1668580517173.png">
<meta property="og:image" content="http://example.com/assets/1668580761089.png">
<meta property="og:image" content="http://example.com/assets/1668581537215.png">
<meta property="og:image" content="http://example.com/assets/1668581678388.png">
<meta property="og:image" content="http://example.com/assets/1668581800777.png">
<meta property="og:image" content="http://example.com/assets/1668582519455.png">
<meta property="og:image" content="http://example.com/assets/1668583255686.png">
<meta property="og:image" content="http://example.com/assets/1668584556229.png">
<meta property="og:image" content="http://example.com/assets/1669603664584.png">
<meta property="og:image" content="http://example.com/assets/1669604102185.png">
<meta property="og:image" content="http://example.com/assets/1669604928912.png">
<meta property="og:image" content="http://example.com/assets/1669605746113.png">
<meta property="og:image" content="http://example.com/assets/1669605786028.png">
<meta property="og:image" content="http://example.com/assets/1669606261919.png">
<meta property="og:image" content="http://example.com/assets/1669606451308.png">
<meta property="og:image" content="http://example.com/assets/1669607820853.png">
<meta property="og:image" content="http://example.com/assets/1669607882128.png">
<meta property="og:image" content="http://example.com/assets/1669619673533.png">
<meta property="og:image" content="http://example.com/assets/1669619922161.png">
<meta property="og:image" content="http://example.com/assets/1669620054411.png">
<meta property="og:image" content="http://example.com/assets/1669620794550.png">
<meta property="og:image" content="http://example.com/assets/1669621045622.png">
<meta property="og:image" content="http://example.com/assets/1669621165245.png">
<meta property="og:image" content="http://example.com/assets/1669621335888.png">
<meta property="og:image" content="http://example.com/assets/1669622545712.png">
<meta property="og:image" content="http://example.com/assets/1669622605490.png">
<meta property="article:published_time" content="2023-01-29T05:50:28.460Z">
<meta property="article:modified_time" content="2023-12-11T05:57:33.556Z">
<meta property="article:author" content="华安">
<meta property="article:tag" content="Java基础">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/assets/1668506399372.png">
  
  
  
  <title>23单元测试、反射 - 萧代</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":100,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>华安</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/9.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="23单元测试、反射"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-01-29 13:50" pubdate>
          2023年1月29日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          22k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          187 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">23单元测试、反射</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="day23-单元测试、反射"><a href="#day23-单元测试、反射" class="headerlink" title="day23-单元测试、反射"></a>day23-单元测试、反射</h1><p>恭喜同学们，Java主要的知识我们其实已经学习得差不多了。今天同学们再把单元测试、反射、注解、动态代理学习完。Java的基础知识就算全齐活了。</p>
<p>首先，我们进入单元测试的学习。</p>
<h2 id="一、单元测试"><a href="#一、单元测试" class="headerlink" title="一、单元测试"></a>一、单元测试</h2><h3 id="1-1-单元测试快速入门"><a href="#1-1-单元测试快速入门" class="headerlink" title="1.1 单元测试快速入门"></a>1.1 单元测试快速入门</h3><p>所谓单元测试，就是针对最小的功能单元，编写测试代码对其进行正确性测试。</p>
<p>我们想想，咱们之前是怎么进行测试的呢？</p>
<p>比如说我们写了一个学生管理系统，有添加学生、修改学生、删除学生、查询学生等这些功能。要对这些功能这几个功能进行测试，我们是在main方法中编写代码来测试的。</p>
<p>但是在main方法中写测试代码有如下的几个问题，如下图所示：</p>
<p><img src="/assets/1668506399372.png" srcset="/img/loading.gif" lazyload alt="1668506399372"></p>
<p>为了测试更加方便，有一些第三方的公司或者组织提供了很好用的测试框架，给开发者使用。这里给同学们介绍一种Junit测试框架。</p>
<p>Junit是第三方公司开源出来的，用于对代码进行单元测试的工具（IDEA已经集成了junit框架）。相比于在main方法中测试有如下几个优点。</p>
<p><img src="/assets/1668506713783.png" srcset="/img/loading.gif" lazyload alt="1668506713783"></p>
<hr>
<p>我们知道单元测试是什么之后，接下来带领同学们使用一下。由于Junit是第三方提供的，所以我们需要把jar包导入到我们的项目中，才能使用，具体步骤如下图所示：</p>
<p><img src="/assets/1668507051101.png" srcset="/img/loading.gif" lazyload alt="1668507051101"></p>
<p>接下来，我们就按照上面的步骤，来使用一下.</p>
<p>先准备一个类，假设写了一个StringUtil工具类，代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringUtil</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printNumber</span><span class="hljs-params">(String name)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;名字长度：&quot;</span>+name.length());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接下来，写一个测试类，测试StringUtil工具类中的方法能否正常使用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringUtilTest</span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testPrintNumber</span><span class="hljs-params">()</span>&#123;<br>        StringUtil.printNumber(<span class="hljs-string">&quot;admin&quot;</span>);<br>        StringUtil.printNumber(<span class="hljs-literal">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>写完代码之后，我们会发现测试方法左边，会有一个绿色的三角形按钮。点击这个按钮，就可以运行测试方法。</p>
<p><img src="/assets/1668507501024.png" srcset="/img/loading.gif" lazyload alt="1668507501024"></p>
<h3 id="1-2-单元测试断言"><a href="#1-2-单元测试断言" class="headerlink" title="1.2 单元测试断言"></a>1.2 单元测试断言</h3><p>接下来，我们学习一个单元测试的断言机制。<strong>所谓断言：意思是程序员可以预测程序的运行结果，检查程序的运行结果是否与预期一致。</strong></p>
<p>我们在StringUtil类中新增一个测试方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getMaxIndex</span><span class="hljs-params">(String data)</span>&#123;<br>    <span class="hljs-keyword">if</span>(data == <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> data.length();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接下来，我们在StringUtilTest类中写一个测试方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringUtilTest</span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetMaxIndex</span><span class="hljs-params">()</span>&#123;<br>       <span class="hljs-type">int</span> <span class="hljs-variable">index1</span> <span class="hljs-operator">=</span> StringUtil.getMaxIndex(<span class="hljs-literal">null</span>);<br>       System.out.println(index1);<br>        <br>       <span class="hljs-type">int</span> <span class="hljs-variable">index2</span> <span class="hljs-operator">=</span> StringUtil.getMaxIndex(<span class="hljs-string">&quot;admin&quot;</span>);<br>       System.out.println(index2);<br>        <br>        <span class="hljs-comment">//断言机制：预测index2的结果</span><br>        Assert.assertEquals(<span class="hljs-string">&quot;方法内部有Bug&quot;</span>,<span class="hljs-number">4</span>,index2);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>运行测试方法，结果如下图所示，表示我们预期值与实际值不一致</p>
<p><img src="/assets/1668508226111.png" srcset="/img/loading.gif" lazyload alt="1668508226111"></p>
<h3 id="1-3-Junit框架的常用注解"><a href="#1-3-Junit框架的常用注解" class="headerlink" title="1.3 Junit框架的常用注解"></a>1.3 Junit框架的常用注解</h3><p>同学们，刚才我们以及学习了@Test注解，可以用来标记一个方法为测试方法，测试才能启动执行。</p>
<p>除了@Test注解，还有一些其他的注解，我们要知道其他注解标记的方法什么时候执行，以及其他注解在什么场景下可以使用。</p>
<p><img src="/assets/1668508373865.png" srcset="/img/loading.gif" lazyload alt="1668508373865"></p>
<p>接下来，我们演示一下其他注解的使用。我们在StringUtilTest测试类中，再新增几个测试方法。代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringUtilTest</span>&#123;<br>    <span class="hljs-meta">@Before</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test1 Before 执行了&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@BeforeClass</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test11</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test11 BeforeClass 执行了&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@After</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test2 After 执行了&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@AfterCalss</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test22</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test22 AfterCalss 执行了&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>执行上面的测试类，结果如下图所示，观察执行结果特点如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1.</span>被<span class="hljs-meta">@BeforeClass</span>标记的方法,执行在所有方法之前<br><span class="hljs-number">2.</span>被<span class="hljs-meta">@AfterCalss</span>标记的方法，执行在所有方法之后<br><span class="hljs-number">3.</span>被<span class="hljs-meta">@Before</span>标记的方法，执行在每一个<span class="hljs-meta">@Test</span>方法之前<br><span class="hljs-number">4.</span>被<span class="hljs-meta">@After</span>标记的方法，执行在每一个<span class="hljs-meta">@Test</span>方法之后<br></code></pre></td></tr></table></figure>

<p><img src="/assets/1668508793279.png" srcset="/img/loading.gif" lazyload alt="1668508793279"></p>
<p>我们现在已经知道每一个注解的作用了，那他们有什么用呢？应用场景在哪里?</p>
<p>我们来看一个例子，假设我想在每个测试方法中使用Socket对象，并且用完之后，需要把Socket关闭。代码就可以按照下面的结构来设计</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringUtilTest</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Socket socket;<br>    <span class="hljs-meta">@Before</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test1 Before 执行了&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@BeforeClass</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test11</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test11 BeforeClass 执行了&quot;</span>);<br>        <span class="hljs-comment">//初始化Socket对象</span><br>        socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Socket</span>();<br>    &#125;<br>    <span class="hljs-meta">@After</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test2 After 执行了&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@AfterCalss</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test22</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;--&gt; test22 AfterCalss 执行了&quot;</span>);<br>         <span class="hljs-comment">//关闭Socket</span><br>        socket.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>最后，我们再补充一点。前面的注解是基于Junit4版本的，再Junit5版本中对注解作了更新，但是作用是一样的。所以这里就不做演示了</p>
<p><img src="/assets/1668509275659.png" srcset="/img/loading.gif" lazyload alt="1668509275659"></p>
<h2 id="二、反射"><a href="#二、反射" class="headerlink" title="二、反射"></a>二、反射</h2><p>各位小伙伴，接下来我们要学习反射技术。在学习反射之前，有几个点需要给同学们提前交代一下，接下来我们学习的反射、动态代理、注解等知识点，在以后开发中极少用到，这些技术都是以后学习框架、或者做框架的底层源码。给同学们讲这些技术的目的，是为了以后我们理解框架、或者自己开发框架给别人用作铺垫的。同时由于这些技术非常抽象，所以按照国际惯例，我们都会采用先带着大家充分的认识它们，然后再了解其作用和应用场景。</p>
<p>接下来，我们就需要带着同学们认识一下什么是反射。其实API文档中对反射有详细的说明，我们去了解一下。在java.lang.reflect包中对反射的解释如下图所示</p>
<p><img src="/assets/1668575265599.png" srcset="/img/loading.gif" lazyload alt="1668575265599"></p>
<p>翻译成人话就是：<strong>反射技术，指的是加载类的字节码到内存，并以编程的方法解刨出类中的各个成分（成员变量、方法、构造器等）。</strong></p>
<p>反射有啥用呢？其实反射是用来写框架用的，但是现阶段同学们对框架还没有太多感觉。为了方便理解，我给同学们看一个我们见过的例子：平时我们用IDEA开发程序时，用对象调用方法，IDEA会有代码提示，idea会将这个对象能调用的方法都给你列举出来，供你选择，如果下图所示</p>
<p><img src="/assets/1668575796295.png" srcset="/img/loading.gif" lazyload alt="1668575796295"></p>
<p>问题是IDEA怎么知道这个对象有这些方法可以调用呢? 原因是对象能调用的方法全都来自于类，IDEA通过反射技术就可以获取到类中有哪些方法，并且把方法的名称以提示框的形式显示出来，所以你能看到这些提示了。</p>
<p>那记事本写代码为什么没有提示呢? 因为技术本软件没有利用反射技术开发这种代码提示的功能，哈哈！！</p>
<p>好了，认识了反射是什么之后，接下来我还想给同学们介绍一下反射具体学什么？</p>
<p>因为反射获取的是类的信息，那么反射的第一步首先获取到类才行。由于Java的设计原则是万物皆对象，获取到的类其实也是以对象的形式体现的，<strong>叫字节码对象</strong>，用Class类来表示。获取到字节码对象之后，再通过字节码对象就可以获取到类的组成成分了，这些组成成分其实也是对象，其中<strong>每一个成员变量用Field类的对象来表示</strong>、<strong>每一个成员方法用Method类的对象来表示</strong>，<strong>每一个构造器用Constructor类的对象来表示</strong>。</p>
<p>如下图所示：</p>
<p><img src="/assets/1668576426355.png" srcset="/img/loading.gif" lazyload alt="1668576426355"></p>
<h3 id="1-1-获取类的字节码"><a href="#1-1-获取类的字节码" class="headerlink" title="1.1 获取类的字节码"></a>1.1 获取类的字节码</h3><p>反射的第一步：是将字节码加载到内存，我们需要获取到的字节码对象。</p>
<p><img src="/assets/1668576691591.png" srcset="/img/loading.gif" lazyload alt="1668576691591"></p>
<p>比如有一个Student类，获取Student类的字节码代码有三种写法。不管用哪一种方式，获取到的字节码对象其实是同一个。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test1Class</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> Student.class;<br>        System.out.println(c1.getName()); <span class="hljs-comment">//获取全类名</span><br>        System.out.println(c1.getSimpleName()); <span class="hljs-comment">//获取简单类名</span><br>        <br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.itheima.d2_reflect.Student&quot;</span>);<br>        System.out.println(c1 == c2); <span class="hljs-comment">//true</span><br>        <br>        <span class="hljs-type">Student</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c3</span> <span class="hljs-operator">=</span> s.getClass();<br>        System.out.println(c2 == c3); <span class="hljs-comment">//true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="1-2-获取类的构造器"><a href="#1-2-获取类的构造器" class="headerlink" title="1.2 获取类的构造器"></a>1.2 获取类的构造器</h3><p>同学们，上一节我们已经可以获取到类的字节码对象了。接下来，我们学习一下通过字节码对象获取构造器，并使用构造器创建对象。</p>
<p>获取构造器，需要用到Class类提供的几个方法，如下图所示：</p>
<p><img src="/assets/1668577010983.png" srcset="/img/loading.gif" lazyload alt="1668577010983"></p>
<p>想要快速记住这个方法的区别，给同学们说一下这些方法的命名规律，按照规律来记就很方便了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">get:获取<br>Declared: 有这个单词表示可以获取任意一个，没有这个单词表示只能获取一个<span class="hljs-keyword">public</span>修饰的<br>Constructor: 构造方法的意思<br>后缀s: 表示可以获取多个，没有后缀s只能获取一个<br></code></pre></td></tr></table></figure>

<p>话不多少，上代码。假设现在有一个Cat类，里面有几个构造方法，代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Cat</span><span class="hljs-params">()</span>&#123;<br>        <br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Cat</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span>&#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li><ol>
<li>接下来，我们写一个测试方法，来测试获取类中所有的构造器</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test2Constructor</span>()&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetConstructors</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//1、反射第一步：必须先得到这个类的Class对象</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Cat.class;<br>        <br>        <span class="hljs-comment">//2、获取类的全部构造器</span><br>        Constructor[] constructors = c.getDeclaredConstructors();<br>        <span class="hljs-comment">//3、遍历数组中的每一个构造器对象。</span><br>        <span class="hljs-keyword">for</span>(Constructor constructor: constructors)&#123;<br>            System.out.println(constructor.getName()+<span class="hljs-string">&quot;---&gt; 参数个数：&quot;</span>+constructor.getParameterCount());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>运行测试方法打印结果如下</p>
<p><img src="/assets/1668578112815.png" srcset="/img/loading.gif" lazyload alt="1668578112815"></p>
<ul>
<li><ol start="2">
<li>刚才演示的是获取Cat类中所有的构造器，接下来，我们演示单个构造器试一试</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test2Constructor</span>()&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetConstructor</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//1、反射第一步：必须先得到这个类的Class对象</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Cat.class;<br>        <br>        <span class="hljs-comment">//2、获取类public修饰的空参数构造器</span><br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor1</span> <span class="hljs-operator">=</span> c.getConstructor();<br>        System.out.println(constructor1.getName()+<span class="hljs-string">&quot;---&gt; 参数个数：&quot;</span>+constructor1.getParameterCount());<br>        <br>        <span class="hljs-comment">//3、获取private修饰的有两个参数的构造器，第一个参数String类型，第二个参数int类型</span><br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor2</span> <span class="hljs-operator">=</span> <br>            c.getDeclaredConstructor(String.class,<span class="hljs-type">int</span>.class);<br>        <br>        System.out.println(constructor2.getName()+<span class="hljs-string">&quot;---&gt; 参数个数：&quot;</span>+constructor1.getParameterCount());<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>打印结果如下</p>
<p><img src="/assets/1668578397467.png" srcset="/img/loading.gif" lazyload alt="1668578397467"></p>
<h3 id="1-3-反射获取构造器的作用"><a href="#1-3-反射获取构造器的作用" class="headerlink" title="1.3 反射获取构造器的作用"></a>1.3 反射获取构造器的作用</h3><p>同学们，刚才上一节我们已经获取到了Cat类中的构造器。获取到构造器后，有什么作用呢？</p>
<p>其实构造器的作用：<strong>初始化对象并返回</strong>。</p>
<p>这里我们需要用到如下的两个方法，注意：这两个方法时属于Constructor的，需要用Constructor对象来调用。 </p>
<p><img src="/assets/1668578639149.png" srcset="/img/loading.gif" lazyload alt="1668578639149"></p>
<p>如下图所示，constructor1和constructor2分别表示Cat类中的两个构造器。现在我要把这两个构造器执行起来</p>
<p><img src="/assets/1668578807439.png" srcset="/img/loading.gif" lazyload alt="1668578807439"></p>
<p>由于构造器是private修饰的，先需要调用<code>setAccessible(true)</code> 表示禁止检查访问控制，然后再调用<code>newInstance(实参列表)</code> 就可以执行构造器，完成对象的初始化了。</p>
<p>代码如下：为了看到构造器真的执行， 故意在两个构造器中分别加了两个打印语句</p>
<p><img src="/assets/1668579315586.png" srcset="/img/loading.gif" lazyload alt="1668579315586"></p>
<p>代码的执行结果如下图所示：</p>
<p><img src="/assets/1668579177901.png" srcset="/img/loading.gif" lazyload alt="1668579177901"></p>
<h3 id="1-4-反射获取成员变量-amp-使用"><a href="#1-4-反射获取成员变量-amp-使用" class="headerlink" title="1.4 反射获取成员变量&amp;使用"></a>1.4 反射获取成员变量&amp;使用</h3><p>同学们，上一节我们已经学习了获取类的构造方法并使用。接下来，我们再学习获取类的成员变量，并使用。</p>
<p>其实套路是一样的，在Class类中提供了获取成员变量的方法，如下图所示。</p>
<p><img src="/assets/1668579517323.png" srcset="/img/loading.gif" lazyload alt="1668579517323"></p>
<p>这些方法的记忆规则，如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">get:获取<br>Declared: 有这个单词表示可以获取任意一个，没有这个单词表示只能获取一个<span class="hljs-keyword">public</span>修饰的<br>Field: 成员变量的意思<br>后缀s: 表示可以获取多个，没有后缀s只能获取一个<br></code></pre></td></tr></table></figure>

<ul>
<li>假设有一个Cat类它有若干个成员变量，用Class类提供 的方法将成员变量的对象获取出来。</li>
</ul>
<p><img src="/assets/1668579681294.png" srcset="/img/loading.gif" lazyload alt="1668579681294"></p>
<p>执行完上面的代码之后，我们可以看到控制台上打印输出了，每一个成员变量的名称和它的类型。</p>
<p><img src="/assets/1668579804732.png" srcset="/img/loading.gif" lazyload alt="1668579804732"></p>
<ul>
<li>获取到成员变量的对象之后该如何使用呢？</li>
</ul>
<p>在Filed类中提供给给成员变量赋值和获取值的方法，如下图所示。</p>
<p><img src="/assets/1668580075962.png" srcset="/img/loading.gif" lazyload alt="1668580075962"></p>
<p>再次强调一下设置值、获取值的方法时Filed类的需要用Filed类的对象来调用，而且不管是设置值、还是获取值，都需要依赖于该变量所属的对象。代码如下</p>
<p><img src="/assets/1668580288930.png" srcset="/img/loading.gif" lazyload alt="1668580288930"></p>
<p>执行代码，控制台会有如下的打印</p>
<p><img src="/assets/1668580517173.png" srcset="/img/loading.gif" lazyload alt="1668580517173"></p>
<h3 id="1-5-反射获取成员方法"><a href="#1-5-反射获取成员方法" class="headerlink" title="1.5 反射获取成员方法"></a>1.5 反射获取成员方法</h3><p>各位同学，上面几节我们已经学习了反射获取构造方法、反射获取成员变量，还剩下最后一个就是反射获取成员方法并使用了。</p>
<p>在Java中反射包中，每一个成员方法用Method对象来表示，通过Class类提供的方法可以获取类中的成员方法对象。如下下图所示</p>
<p><img src="/assets/1668580761089.png" srcset="/img/loading.gif" lazyload alt="1668580761089"></p>
<p>接下来我们还是用代码演示一下：假设有一个Cat类，在Cat类中红有若干个成员方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Cat</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;空参数构造方法执行了&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Cat</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;有参数构造方法执行了&quot;</span>);<br>        <span class="hljs-built_in">this</span>.name=name;<br>        <span class="hljs-built_in">this</span>.age=age;<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;(&gt;^ω^&lt;)喵跑得贼快~~&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;(&gt;^ω^&lt;)喵爱吃猫粮~&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">eat</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;(&gt;^ω^&lt;)喵爱吃:&quot;</span>+name;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name=name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span>&#123;<br>        <span class="hljs-built_in">this</span>.age=age;<br>    &#125;<br>     <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接下来，通过反射获取Cat类中所有的成员方法，每一个成员方法都是一个Method对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test3Method</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-comment">//1、反射第一步：先获取到Class对象</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Cat.class;<br>        <br>        <span class="hljs-comment">//2、获取类中的全部成员方法</span><br>        Method[] methods = c.getDecalaredMethods();<br>        <br>        <span class="hljs-comment">//3、遍历这个数组中的每一个方法对象</span><br>        <span class="hljs-keyword">for</span>(Method method : methods)&#123;<br>            System.out.println(method.getName()+<span class="hljs-string">&quot;--&gt;&quot;</span>+method.getParameterCount()+<span class="hljs-string">&quot;--&gt;&quot;</span>+method.getReturnType());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>执行上面的代码，运行结果如下图所示：<strong>打印输出每一个成员方法的名称、参数格式、返回值类型</strong></p>
<p><img src="/assets/1668581537215.png" srcset="/img/loading.gif" lazyload alt="1668581537215"></p>
<p>也能获取单个指定的成员方法，如下图所示</p>
<p><img src="/assets/1668581678388.png" srcset="/img/loading.gif" lazyload alt="1668581678388"></p>
<hr>
<p><strong>获取到成员方法之后，有什么作用呢？</strong></p>
<p>在Method类中提供了方法，可以将方法自己执行起来。</p>
<p><img src="/assets/1668581800777.png" srcset="/img/loading.gif" lazyload alt="1668581800777"></p>
<p>下面我们演示一下，把<code>run()</code>方法和<code>eat(String name)</code>方法执行起来。看分割线之下的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test3Method</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-comment">//1、反射第一步：先获取到Class对象</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Cat.class;<br>        <br>        <span class="hljs-comment">//2、获取类中的全部成员方法</span><br>        Method[] methods = c.getDecalaredMethods();<br>        <br>        <span class="hljs-comment">//3、遍历这个数组中的每一个方法对象</span><br>        <span class="hljs-keyword">for</span>(Method method : methods)&#123;<br>            System.out.println(method.getName()+<span class="hljs-string">&quot;--&gt;&quot;</span>+method.getParameterCount()+<span class="hljs-string">&quot;--&gt;&quot;</span>+method.getReturnType());<br>        &#125;<br>        <br>        System.out.println(<span class="hljs-string">&quot;-----------------------&quot;</span>);<br>        <span class="hljs-comment">//4、获取private修饰的run方法，得到Method对象</span><br>        <span class="hljs-type">Method</span> <span class="hljs-variable">run</span> <span class="hljs-operator">=</span> c.getDecalaredMethod(<span class="hljs-string">&quot;run&quot;</span>);<br>        <span class="hljs-comment">//执行run方法,在执行前需要取消权限检查</span><br>        <span class="hljs-type">Cat</span> <span class="hljs-variable">cat</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();<br>        run.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">rs1</span> <span class="hljs-operator">=</span> run.invoke(cat);<br>        System.out.println(rs1)<br>        <br>        <span class="hljs-comment">//5、获取private 修饰的eat(String name)方法，得到Method对象</span><br>        <span class="hljs-type">Method</span> <span class="hljs-variable">eat</span> <span class="hljs-operator">=</span> c.getDeclaredMethod(<span class="hljs-string">&quot;eat&quot;</span>,String.class);<br>        eat.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">rs2</span> <span class="hljs-operator">=</span> eat.invoke(cat,<span class="hljs-string">&quot;鱼儿&quot;</span>);<br>        System.out.println(rs2)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>打印结果如下图所示：run()方法执行后打印<code>猫跑得贼快~~</code>，返回<code>null</code>； eat()方法执行完，直接返回<code>猫最爱吃:鱼儿</code></p>
<p><img src="/assets/1668582519455.png" srcset="/img/loading.gif" lazyload alt="1668582519455"></p>
<h3 id="1-6-反射的应用"><a href="#1-6-反射的应用" class="headerlink" title="1.6 反射的应用"></a>1.6 反射的应用</h3><p>各位小伙伴，按照前面我们学习反射的套路，我们已经充分认识了什么是反射，以及反射的核心作用是用来获取类的各个组成部分并执行他们。但是由于同学们的经验有限，对于反射的具体应用场景还是很难感受到的（这个目前没有太好的办法，只能慢慢积累，等经验积累到一定程度，就会豁然开朗了）。</p>
<p>我们一直说反射使用来写框架的，接下来，我们就写一个简易的框架，简单窥探一下反射的应用。反射其实是非常强大的，这个案例也仅仅值小试牛刀。</p>
<p><img src="/assets/1668583255686.png" srcset="/img/loading.gif" lazyload alt="1668583255686"></p>
<p>需求是让我们写一个框架，能够将任意一个对象的属性名和属性值写到文件中去。不管这个对象有多少个属性，也不管这个对象的属性名是否相同。</p>
<p>分析一下该怎么做</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1.</span>先写好两个类，一个Student类和Teacher类<br><span class="hljs-number">2.</span>写一个ObjectFrame类代表框本架<br>	在ObjectFrame类中定义一个saveObject(Object obj)方法，用于将任意对象存到文件中去<br>	参数：Object obj: 就表示要存入文件中的对象<br>	<br><span class="hljs-number">3.</span>编写方法内部的代码，往文件中存储对象的属性名和属性值<br>	<span class="hljs-number">1</span>)参数obj对象中有哪些属性，属性名是什么实现值是什么，中有对象自己最清楚。<br>	<span class="hljs-number">2</span>)接着就通过反射获取类的成员变量信息了（变量名、变量值）<br>	<span class="hljs-number">3</span>)把变量名和变量值写到文件中去<br></code></pre></td></tr></table></figure>

<p>写一个ObjectFrame表示自己设计的框架，代码如下图所示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectFrame</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveObject</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        <span class="hljs-type">PrintStream</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> <br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;模块名\\src\\data.txt&quot;</span>,<span class="hljs-literal">true</span>));<br>        <span class="hljs-comment">//1)参数obj对象中有哪些属性，属性名是什么实现值是什么，中有对象自己最清楚。</span><br>		<span class="hljs-comment">//2)接着就通过反射获取类的成员变量信息了（变量名、变量值）</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> obj.getClass(); <span class="hljs-comment">//获取字节码</span><br>        ps.println(<span class="hljs-string">&quot;---------&quot;</span>+class.getSimpleName()+<span class="hljs-string">&quot;---------&quot;</span>);<br>        <br>        Field[] fields = c.getDeclaredFields(); <span class="hljs-comment">//获取所有成员变量</span><br>		<span class="hljs-comment">//3)把变量名和变量值写到文件中去</span><br>        <span class="hljs-keyword">for</span>(Field field : fields)&#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> field.getName();<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> field.get(obj)+<span class="hljs-string">&quot;&quot;</span>;<br>            ps.println(name);<br>        &#125;<br>        ps.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用自己设计的框架，往文件中写入Student对象的信息和Teacher对象的信息。</p>
<p>先准备好Student类和Teacher类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">char</span> sex;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> height;<br>    <span class="hljs-keyword">private</span> String hobby;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Teacher</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salary;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>创建一个测试类，在测试中类创建一个Student对象，创建一个Teacher对象，用ObjectFrame的方法把这两个对象所有的属性名和属性值写到文件中去。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test5Frame</span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        <span class="hljs-type">Student</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;黑马吴彦祖&quot;</span>,<span class="hljs-number">45</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">185.3</span>, <span class="hljs-string">&quot;篮球，冰球，阅读&quot;</span>);<br>        <span class="hljs-type">Teacher</span> <span class="hljs-variable">s2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>(<span class="hljs-string">&quot;播妞&quot;</span>,<span class="hljs-number">999.9</span>);<br>        <br>        ObjectFrame.save(s1);<br>        ObjectFrame.save(s2);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>打开data.txt文件，内容如下图所示，就说明我们这个框架的功能已经实现了</p>
<p><img src="/assets/1668584556229.png" srcset="/img/loading.gif" lazyload alt="1668584556229"></p>
<p>好了，同学们，恭喜大家！学习到这里，反射技术已经学习完毕了。</p>
<hr>
<h2 id="三、注解"><a href="#三、注解" class="headerlink" title="三、注解"></a>三、注解</h2><h3 id="3-1-认识注解-amp-定义注解"><a href="#3-1-认识注解-amp-定义注解" class="headerlink" title="3.1 认识注解&amp;定义注解"></a>3.1 认识注解&amp;定义注解</h3><p>各位小伙伴，接下来我们学习注解。注解和反射一样，都是用来做框架的，我们这里学习注解的目的其实是为了以后学习框架或者做框架做铺垫的。</p>
<p>那注解该怎么学呢？和反射的学习套路一样，我们先充分的认识注解，掌握注解的定义和使用格式，然后再学习它的应用场景。</p>
<blockquote>
<p><strong>先来认识一下什么是注解？</strong></p>
</blockquote>
<p><strong>Java注解是代码中的特殊标记，比如@Override、@Test等，作用是：让其他程序根据注解信息决定怎么执行该程序。</strong></p>
<p>比如：Junit框架的@Test注解可以用在方法上，用来标记这个方法是测试方法，被@Test标记的方法能够被Junit框架执行。</p>
<p>再比如：@Override注解可以用在方法上，用来标记这个方法是重写方法，被@Override注解标记的方法能够被IDEA识别进行语法检查。</p>
<p><img src="/assets/1669603664584.png" srcset="/img/loading.gif" lazyload alt="1669603664584"></p>
<ul>
<li><strong>注解不光可以用在方法上，还可以用在类上、变量上、构造器上等位置。</strong></li>
</ul>
<p>上面我们说的@Test注解、@Overide注解是别人定义好给我们用的，将来如果需要自己去开发框架，就需要我们自己定义注解。</p>
<blockquote>
<p><strong>接着我们学习自定义注解</strong></p>
</blockquote>
<p>自定义注解的格式如下图所示</p>
<p><img src="/assets/1669604102185.png" srcset="/img/loading.gif" lazyload alt="1669604102185"></p>
<p>比如：现在我们自定义一个MyTest注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> MyTest&#123;<br>    String <span class="hljs-title function_">aaa</span><span class="hljs-params">()</span>;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">bbb</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-literal">true</span>;	<span class="hljs-comment">//default true 表示默认值为true,使用时可以不赋值。</span><br>    String[] ccc();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>定义好MyTest注解之后，我们可以使用MyTest注解在类上、方法上等位置做标记。注意使用注解时需要加@符号，如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@MyTest1(aaa=&quot;牛魔王&quot;,ccc=&#123;&quot;HTML&quot;,&quot;Java&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnnotationTest1</span>&#123;<br>    <span class="hljs-meta">@MyTest(aaa=&quot;铁扇公主&quot;,bbb=false, ccc=&#123;&quot;Python&quot;,&quot;前端&quot;,&quot;Java&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注意：注解的属性名如何是value的话，并且只有value没有默认值，使用注解时value名称可以省略。比如现在重新定义一个MyTest2注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> MyTest2&#123;<br>    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span>; <span class="hljs-comment">//特殊属性</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">age</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-number">10</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>定义好MyTest2注解后，再将@MyTest2标记在类上，此时value属性名可以省略，代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@MyTest2(&quot;孙悟空&quot;)</span> <span class="hljs-comment">//等价于 @MyTest2(value=&quot;孙悟空&quot;)</span><br><span class="hljs-meta">@MyTest1(aaa=&quot;牛魔王&quot;,ccc=&#123;&quot;HTML&quot;,&quot;Java&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnnotationTest1</span>&#123;<br>    <span class="hljs-meta">@MyTest(aaa=&quot;铁扇公主&quot;,bbb=false, ccc=&#123;&quot;Python&quot;,&quot;前端&quot;,&quot;Java&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>到这里关于定义注解的格式、以及使用注解的格式就学习完了。</p>
<blockquote>
<p><strong>注解本质是什么呢？</strong></p>
</blockquote>
<p>想要搞清楚注解本质是什么东西，我们可以把注解的字节码进行反编译，使用XJad工具进行反编译。经过对MyTest1注解字节码反编译我们会发现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1.</span>MyTest1注解本质上是接口，每一个注解接口都继承子Annotation接口<br><span class="hljs-number">2.</span>MyTest1注解中的属性本质上是抽象方法<br><span class="hljs-number">3.</span><span class="hljs-meta">@MyTest1</span>实际上是作为MyTest接口的实现类对象<br><span class="hljs-number">4.</span><span class="hljs-meta">@MyTest1(aaa=&quot;孙悟空&quot;,bbb=false,ccc=&#123;&quot;Python&quot;,&quot;前端&quot;,&quot;Java&quot;&#125;)</span>里面的属性值，可以通过调用aaa()、bbb()、ccc()方法获取到。 【别着急，继续往下看，再解析注解时会用到】<br></code></pre></td></tr></table></figure>

<p><img src="/assets/1669604928912.png" srcset="/img/loading.gif" lazyload alt="1669604928912"></p>
<h3 id="3-2-元注解"><a href="#3-2-元注解" class="headerlink" title="3.2 元注解"></a>3.2 元注解</h3><p>各位小伙伴，刚才我们已经认识了注解以及注解的基本使用。接下来我们还需要学习几种特殊的注解，叫做元注解。</p>
<blockquote>
<p><strong>什么是元注解？</strong></p>
</blockquote>
<p><strong>元注解是修饰注解的注解</strong>。这句话虽然有一点饶，但是非常准确。我们看一个例子</p>
<p><img src="/assets/1669605746113.png" srcset="/img/loading.gif" lazyload alt="1669605746113"></p>
<p>接下来分别看一下@Target注解和@Retention注解有什么作用，如下图所示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target</span>是用来声明注解只能用在那些位置，比如：类上、方法上、成员变量上等<br><span class="hljs-meta">@Retetion</span>是用来声明注解保留周期，比如：源代码时期、字节码时期、运行时期<br></code></pre></td></tr></table></figure>

<p><img src="/assets/1669605786028.png" srcset="/img/loading.gif" lazyload alt="1669605786028"></p>
<ul>
<li>@Target元注解的使用：比如定义一个MyTest3注解，并添加@Target注解用来声明MyTest3的使用位置</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.TYPE)</span>	<span class="hljs-comment">//声明@MyTest3注解只能用在类上</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> MyTest3&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<p>接下来，我们把@MyTest3用来类上观察是否有错，再把@MyTest3用在方法上、变量上再观察是否有错</p>
<p><img src="/assets/1669606261919.png" srcset="/img/loading.gif" lazyload alt="1669606261919"></p>
<p>如果我们定义MyTest3注解时，使用@Target注解属性值写成下面样子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//声明@MyTest3注解只能用在类上和方法上</span><br><span class="hljs-meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span>	<br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> MyTest3&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<p>此时再观察，@MyTest用在类上、方法上、变量上是否有错</p>
<p><img src="/assets/1669606451308.png" srcset="/img/loading.gif" lazyload alt="1669606451308"></p>
<p>到这里@Target元注解的使用就演示完毕了。</p>
<ul>
<li>@Retetion元注解的使用：定义MyTest3注解时，给MyTest3注解添加@Retetion注解来声明MyTest3注解保留的时期</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Retetion</span>是用来声明注解保留周期，比如：源代码时期、字节码时期、运行时期<br>	<span class="hljs-meta">@Retetion(RetetionPloicy.SOURCE)</span>: 注解保留到源代码时期、字节码中就没有了<br>	<span class="hljs-meta">@Retetion(RetetionPloicy.CLASS)</span>: 注解保留到字节码中、运行时注解就没有了<br>	<span class="hljs-meta">@Retetion(RetetionPloicy.RUNTIME)</span>：注解保留到运行时期<br>	【自己写代码时，比较常用的是保留到运行时期】<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//声明@MyTest3注解只能用在类上和方法上</span><br><span class="hljs-meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span>	<br><span class="hljs-comment">//控制使用了@MyTest3注解的代码中，@MyTest3保留到运行时期</span><br><span class="hljs-meta">@Retetion(RetetionPloicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> MyTest3&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="3-3-解析注解"><a href="#3-3-解析注解" class="headerlink" title="3.3 解析注解"></a>3.3 解析注解</h3><p>各位小伙伴，通过前面的学习我们能够自己定义注解，也能够把自己定义的注解标记在类上或者方法上等位置，但是总感觉有点别扭，给类、方法、变量等加上注解后，我们也没有干什么呀！！！</p>
<p>接下来，我们就要做点什么。我们可以通过反射技术把类上、方法上、变量上的注解对象获取出来，然后通过调用方法就可以获取注解上的属性值了。<strong>我们把获取类上、方法上、变量上等位置注解及注解属性值的过程称为解析注解。</strong></p>
<p>解析注解套路如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1.</span>如果注解在类上，先获取类的字节码对象，再获取类上的注解<br><span class="hljs-number">2.</span>如果注解在方法上，先获取方法对象，再获取方法上的注解<br><span class="hljs-number">3.</span>如果注解在成员变量上，先获取成员变量对象，再获取变量上的注解<br>总之：注解在谁身上，就先获取谁，再用谁获取谁身上的注解<br></code></pre></td></tr></table></figure>

<p><img src="/assets/1669607820853.png" srcset="/img/loading.gif" lazyload alt="1669607820853"></p>
<p>解析来看一个案例，来演示解析注解的代码编写</p>
<p><img src="/assets/1669607882128.png" srcset="/img/loading.gif" lazyload alt="1669607882128"></p>
<p>按照需求要求一步一步完成</p>
<p>① 先定义一个MyTest4注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//声明@MyTest4注解只能用在类上和方法上</span><br><span class="hljs-meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span>	<br><span class="hljs-comment">//控制使用了@MyTest4注解的代码中，@MyTest4保留到运行时期</span><br><span class="hljs-meta">@Retetion(RetetionPloicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> MyTest4&#123;<br>    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span>;<br>    <span class="hljs-type">double</span> <span class="hljs-title function_">aaa</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-number">100</span>;<br>    String[] bbb();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>② 定义有一个类Demo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@MyTest4(value=&quot;蜘蛛侠&quot;,aaa=99.9, bbb=&#123;&quot;至尊宝&quot;,&quot;黑马&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span>&#123;<br>    <span class="hljs-meta">@MyTest4(value=&quot;孙悟空&quot;,aaa=199.9, bbb=&#123;&quot;紫霞&quot;,&quot;牛夫人&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>③ 写一个测试类AnnotationTest3解析Demo类上的MyTest4注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnnotationTest3</span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parseClass</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//1.先获取Class对象</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Demo.class;<br>        <br>        <span class="hljs-comment">//2.解析Demo类上的注解</span><br>        <span class="hljs-keyword">if</span>(c.isAnnotationPresent(MyTest4.class))&#123;<br>            <span class="hljs-comment">//获取类上的MyTest4注解</span><br>            <span class="hljs-type">MyTest4</span> <span class="hljs-variable">myTest4</span> <span class="hljs-operator">=</span> (MyTest4)c.getDeclaredAnnotation(MyTest4.class);<br>            <span class="hljs-comment">//获取MyTests4注解的属性值</span><br>            System.out.println(myTest4.value());<br>            System.out.println(myTest4.aaa());<br>            System.out.println(myTest4.bbb());<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parseMethods</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//1.先获取Class对象</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Demo.class;<br>        <br>        <span class="hljs-comment">//2.解析Demo类中test1方法上的注解MyTest4注解</span><br>        <span class="hljs-type">Method</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> c.getDeclaredMethod(<span class="hljs-string">&quot;test1&quot;</span>);<br>        <span class="hljs-keyword">if</span>(m.isAnnotationPresent(MyTest4.class))&#123;<br>            <span class="hljs-comment">//获取方法上的MyTest4注解</span><br>            <span class="hljs-type">MyTest4</span> <span class="hljs-variable">myTest4</span> <span class="hljs-operator">=</span> (MyTest4)m.getDeclaredAnnotation(MyTest4.class);<br>            <span class="hljs-comment">//获取MyTests4注解的属性值</span><br>            System.out.println(myTest4.value());<br>            System.out.println(myTest4.aaa());<br>            System.out.println(myTest4.bbb());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="3-4-注解的应用场景"><a href="#3-4-注解的应用场景" class="headerlink" title="3.4 注解的应用场景"></a>3.4 注解的应用场景</h3><p>各位同学，关于注解的定义、使用、解析注解就已经学习完了。接下来，我们再学习一下注解的应用场景，注解是用来写框架的，比如现在我们要模拟Junit写一个测试框架，要求有@MyTest注解的方法可以被框架执行，没有@MyTest注解的方法不能被框架执行。</p>
<p>第一步：先定义一个MyTest注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.METHOD)</span>	<br><span class="hljs-meta">@Retetion(RetetionPloicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> MyTest&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<p>第二步：写一个测试类AnnotationTest4，在类中定义几个被@MyTest注解标记的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnnotationTest4</span>&#123;<br>    <span class="hljs-meta">@MyTest</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;=====test1====&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-meta">@MyTest</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;=====test2====&quot;</span>);<br>    &#125;<br>    <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;=====test2====&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-type">AnnotationTest4</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnnotationTest4</span>();<br>        <br>        <span class="hljs-comment">//1.先获取Class对象</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> AnnotationTest4.class;<br>        <br>        <span class="hljs-comment">//2.解析AnnotationTest4类中所有的方法对象</span><br>        Method[] methods = c.getDeclaredMethods();<br>        <span class="hljs-keyword">for</span>(Method m: methods)&#123;<br>            <span class="hljs-comment">//3.判断方法上是否有MyTest注解，有就执行该方法</span><br>            <span class="hljs-keyword">if</span>(m.isAnnotationPresent(MyTest.class))&#123;<br>            	m.invoke(a);<br>        	&#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>恭喜小伙伴们，学习到这里，关于注解的使用就学会了(<em>^▽^</em>)</p>
<h2 id="四、动态代理"><a href="#四、动态代理" class="headerlink" title="四、动态代理"></a>四、动态代理</h2><h3 id="4-1-动态代理介绍、准备功能"><a href="#4-1-动态代理介绍、准备功能" class="headerlink" title="4.1 动态代理介绍、准备功能"></a>4.1 动态代理介绍、准备功能</h3><p>各位同学，这节课我们学习一个Java的高级技术叫做动态代理。首先我们认识一下代理长什么样？我们以大明星“杨超越”例。</p>
<p>假设现在有一个大明星叫杨超越，它有唱歌和跳舞的本领，作为大明星是要用唱歌和跳舞来赚钱的，但是每次做节目，唱歌的时候要准备话筒、收钱，再唱歌；跳舞的时候也要准备场地、收钱、再唱歌。杨超越越觉得我擅长的做的事情是唱歌，和跳舞，但是每次唱歌和跳舞之前或者之后都要做一些繁琐的事情，有点烦。于是杨超越就找个一个经济公司，请了一个代理人，代理杨超越处理这些事情，如果有人想请杨超越演出，直接找代理人就可以了。如下图所示</p>
<p><img src="/assets/1669619673533.png" srcset="/img/loading.gif" lazyload alt="1669619673533"></p>
<p>我们说杨超越的代理是中介公司派的，那中介公司怎么知道，要派一个有唱歌和跳舞功能的代理呢？</p>
<p>解决这个问题，Java使用的是接口，杨超越想找代理，在Java中需要杨超越实现了一个接口，接口中规定要唱歌和跳舞的方法。Java就可以通过这个接口为杨超越生成一个代理对象，只要接口中有的方法代理对象也会有。</p>
<p><img src="/assets/1669619922161.png" srcset="/img/loading.gif" lazyload alt="1669619922161"></p>
<p>接下来我们就先把有唱歌和跳舞功能的接口，和实现接口的大明星类定义出来。</p>
<p><img src="/assets/1669620054411.png" srcset="/img/loading.gif" lazyload alt="1669620054411"></p>
<h3 id="4-2-生成动态代理对象"><a href="#4-2-生成动态代理对象" class="headerlink" title="4.2 生成动态代理对象"></a>4.2 生成动态代理对象</h3><p>下面我们写一个为BigStar生成动态代理对象的工具类。这里需要用Java为开发者提供的一个生成代理对象的类叫Proxy类。</p>
<p>通过Proxy类的newInstance(…)方法可以为实现了同一接口的类生成代理对象。 调用方法时需要传递三个参数，该方法的参数解释可以查阅API文档，如下。</p>
<p><img src="/assets/1669620794550.png" srcset="/img/loading.gif" lazyload alt="1669620794550"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyUtil</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Star <span class="hljs-title function_">createProxy</span><span class="hljs-params">(BigStar bigStar)</span>&#123;<br>       <span class="hljs-comment">/* newProxyInstance(ClassLoader loader,</span><br><span class="hljs-comment">                Class&lt;?&gt;[] interfaces,</span><br><span class="hljs-comment">                InvocationHandler h)</span><br><span class="hljs-comment">                参数1：用于指定一个类加载器</span><br><span class="hljs-comment">                参数2：指定生成的代理长什么样子，也就是有哪些方法</span><br><span class="hljs-comment">                参数3：用来指定生成的代理对象要干什么事情</span><br><span class="hljs-comment">                */</span><br>        <span class="hljs-comment">// Star starProxy = ProxyUtil.createProxy(s);</span><br>        <span class="hljs-comment">// starProxy.sing(&quot;好日子&quot;) starProxy.dance()</span><br>        <span class="hljs-type">Star</span> <span class="hljs-variable">starProxy</span> <span class="hljs-operator">=</span> (Star) Proxy.newProxyInstance(ProxyUtil.class.getClassLoader(),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Star.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvocationHandler</span>() &#123;<br>                    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// 回调方法</span><br>                    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>                        <span class="hljs-comment">// 代理对象要做的事情，会在这里写代码</span><br>                        <span class="hljs-keyword">if</span>(method.getName().equals(<span class="hljs-string">&quot;sing&quot;</span>))&#123;<br>                            System.out.println(<span class="hljs-string">&quot;准备话筒，收钱20万&quot;</span>);<br>                        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(method.getName().equals(<span class="hljs-string">&quot;dance&quot;</span>))&#123;<br>                            System.out.println(<span class="hljs-string">&quot;准备场地，收钱1000万&quot;</span>);<br>                        &#125;<br>                        <span class="hljs-keyword">return</span> method.invoke(bigStar, args);<br>                    &#125;<br>                &#125;);<br>        <span class="hljs-keyword">return</span> starProxy;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>调用我们写好的ProxyUtil工具类，为BigStar对象生成代理对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">BigStar</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigStar</span>(<span class="hljs-string">&quot;杨超越&quot;</span>);<br>        <span class="hljs-type">Star</span> <span class="hljs-variable">starProxy</span> <span class="hljs-operator">=</span> ProxyUtil.createProxy(s);<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> starProxy.sing(<span class="hljs-string">&quot;好日子&quot;</span>);<br>        System.out.println(rs);<br><br>        starProxy.dance();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>运行测试类，结果如下图所示</p>
<p><img src="/assets/1669621045622.png" srcset="/img/loading.gif" lazyload alt="1669621045622"></p>
<p>恭喜同学们，当你把上面的案例写出来，并且理解，那么动态代理的基本使用就学会了。</p>
<h3 id="4-3-动态代理应用"><a href="#4-3-动态代理应用" class="headerlink" title="4.3 动态代理应用"></a>4.3 动态代理应用</h3><p>学习完动态代理的基本使用之后，接下来我们再做一个应用案例。</p>
<p><img src="/assets/1669621165245.png" srcset="/img/loading.gif" lazyload alt="1669621165245"></p>
<p>现有如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  用户业务接口</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserService</span> &#123;<br>    <span class="hljs-comment">// 登录功能</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">(String loginName,String passWord)</span> <span class="hljs-keyword">throws</span> Exception;<br>    <span class="hljs-comment">// 删除用户</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUsers</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception;<br>    <span class="hljs-comment">// 查询用户，返回数组的形式。</span><br>    String[] selectUsers() <span class="hljs-keyword">throws</span> Exception;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>下面有一个UserService接口的实现类，下面每一个方法中都有计算方法运行时间的代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 用户业务实现类（面向接口编程）</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">(String loginName, String passWord)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">time1</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;admin&quot;</span>.equals(loginName) &amp;&amp; <span class="hljs-string">&quot;123456&quot;</span>.equals(passWord))&#123;<br>            System.out.println(<span class="hljs-string">&quot;您登录成功，欢迎光临本系统~&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;您登录失败，用户名或密码错误~&quot;</span>);<br>        &#125;<br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>        <span class="hljs-type">long</span> <span class="hljs-variable">time2</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;login方法耗时：&quot;</span>+(time2-time1));<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUsers</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">time1</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;成功删除了1万个用户~&quot;</span>);<br>        Thread.sleep(<span class="hljs-number">1500</span>);<br>        <span class="hljs-type">long</span> <span class="hljs-variable">time2</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;deleteUsers方法耗时：&quot;</span>+(time2-time1));<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String[] selectUsers() <span class="hljs-keyword">throws</span> Exception&#123;<br>		<span class="hljs-type">long</span> <span class="hljs-variable">time1</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;查询出了3个用户&quot;</span>);<br>        String[] names = &#123;<span class="hljs-string">&quot;张全蛋&quot;</span>, <span class="hljs-string">&quot;李二狗&quot;</span>, <span class="hljs-string">&quot;牛爱花&quot;</span>&#125;;<br>        Thread.sleep(<span class="hljs-number">500</span>);<br>		<span class="hljs-type">long</span> <span class="hljs-variable">time2</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        System.out.println(<span class="hljs-string">&quot;selectUsers方法耗时：&quot;</span>+(time2-time1));<br>        <span class="hljs-keyword">return</span> names;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>观察上面代码发现有什么问题吗？</p>
<p>我们会发现每一个方法中计算耗时的代码都是重复的，我们可是学习了动态代理的高级程序员，怎么能忍受在每个方法中写重复代码呢！况且这些重复的代码并不属于UserSerivce的主要业务代码。</p>
<p><img src="/assets/1669621335888.png" srcset="/img/loading.gif" lazyload alt="1669621335888"></p>
<p>所以接下来我们打算，把计算每一个方法的耗时操作，交给代理对象来做。</p>
<p>先在UserService类中把计算耗时的代码删除，代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 用户业务实现类（面向接口编程）</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">(String loginName, String passWord)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;admin&quot;</span>.equals(loginName) &amp;&amp; <span class="hljs-string">&quot;123456&quot;</span>.equals(passWord))&#123;<br>            System.out.println(<span class="hljs-string">&quot;您登录成功，欢迎光临本系统~&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;您登录失败，用户名或密码错误~&quot;</span>);<br>        &#125;<br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUsers</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        System.out.println(<span class="hljs-string">&quot;成功删除了1万个用户~&quot;</span>);<br>        Thread.sleep(<span class="hljs-number">1500</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String[] selectUsers() <span class="hljs-keyword">throws</span> Exception&#123;<br><br>        System.out.println(<span class="hljs-string">&quot;查询出了3个用户&quot;</span>);<br>        String[] names = &#123;<span class="hljs-string">&quot;张全蛋&quot;</span>, <span class="hljs-string">&quot;李二狗&quot;</span>, <span class="hljs-string">&quot;牛爱花&quot;</span>&#125;;<br>        Thread.sleep(<span class="hljs-number">500</span>);<br><br>        <span class="hljs-keyword">return</span> names;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后为UserService生成一个动态代理对象，在动态代理中调用目标方法，在调用目标方法之前和之后记录毫秒值，并计算方法运行的时间。代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyUtil</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> UserService <span class="hljs-title function_">createProxy</span><span class="hljs-params">(UserService userService)</span>&#123;<br>        <span class="hljs-type">UserService</span> <span class="hljs-variable">userServiceProxy</span><br>            <span class="hljs-operator">=</span> (UserService) Proxy.newProxyInstance(<br>            ProxyUtil.class.getClassLoader(),<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;UserService.class&#125;, <br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvocationHandler</span>() &#123;<br>                                                                            			<span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(                                                                             Object proxy, </span><br><span class="hljs-params">                              Method method, </span><br><span class="hljs-params">                                  Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;                             <span class="hljs-keyword">if</span>(<br>                    method.getName().equals(<span class="hljs-string">&quot;login&quot;</span>) ||                                             method.getName().equals(<span class="hljs-string">&quot;deleteUsers&quot;</span>)||<br>                    method.getName().equals(<span class="hljs-string">&quot;selectUsers&quot;</span>))&#123;<br>                    <span class="hljs-comment">//方法运行前记录毫秒值         </span><br>                    <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>                    <span class="hljs-comment">//执行方法</span><br>                    <span class="hljs-type">Object</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> method.invoke(userService, args);<br>                    <span class="hljs-comment">//执行方法后记录毫秒值</span><br>                    <span class="hljs-type">long</span> <span class="hljs-variable">endTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br>                    System.out.println(method.getName() + <span class="hljs-string">&quot;方法执行耗时：&quot;</span> + (endTime - startTime)/ <span class="hljs-number">1000.0</span> + <span class="hljs-string">&quot;s&quot;</span>);<br>                    <span class="hljs-keyword">return</span> rs;<br>               &#125;<span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-type">Object</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> method.invoke(userService, args);<br>                    <span class="hljs-keyword">return</span> rs;                                                                &#125;<br>           &#125;                                                                 &#125;);<br>        <span class="hljs-comment">//返回代理对象</span><br>        <span class="hljs-keyword">return</span> userServiceProxy;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在测试类中为UserService创建代理对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 目标：使用动态代理解决实际问题，并掌握使用代理的好处。</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        <span class="hljs-comment">// 1、创建用户业务对象。</span><br>        <span class="hljs-type">UserService</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> ProxyUtil.createProxy(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceImpl</span>());<br><br>        <span class="hljs-comment">// 2、调用用户业务的功能。</span><br>        userService.login(<span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;123456&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;----------------------------------&quot;</span>);<br><br>        userService.deleteUsers();<br>        System.out.println(<span class="hljs-string">&quot;----------------------------------&quot;</span>);<br><br>        String[] names = userService.selectUsers();<br>        System.out.println(<span class="hljs-string">&quot;查询到的用户是：&quot;</span> + Arrays.toString(names));<br>        System.out.println(<span class="hljs-string">&quot;----------------------------------&quot;</span>);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>执行结果如下图所示</p>
<p><img src="/assets/1669622545712.png" srcset="/img/loading.gif" lazyload alt="1669622545712"></p>
<p>动态代理对象的执行流程如下图所示，每次用代理对象调用方法时，都会执行InvocationHandler中的invoke方法。</p>
<p><img src="/assets/1669622605490.png" srcset="/img/loading.gif" lazyload alt="1669622605490"></p>
<p>恭喜同学们，动态代理我们已经学习完了。到此整个JavaSE的课程也学习完了。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Java%E5%9F%BA%E7%A1%80/">#Java基础</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>23单元测试、反射</div>
      <div>http://example.com/2023/01/29/day23-单元测试-反射-注解-动态代理/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>华安</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年1月29日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2023年12月11日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/04/05/%E4%BB%8B%E7%BB%8D/" title="Hello World">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Hello World</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
